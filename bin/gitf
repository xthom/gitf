#!/bin/sh

ROOT_BRANCH="master"
ORIGIN="origin"

task_start(){
  if [[ $# != 1 ]] ; 
    then echo "Enter the name of the branch to open">&2 && exit 1; 
  fi
  require_root_branch
  git checkout -b "$1"
}

task_finish(){
  if [[ $# != 1 ]] ; 
    then echo "Enter the name of the branch to close and finish">&2 && exit 1; 
  fi
  require_root_branch
  git merge --no-ff "$1"
  git tag -s "$1"
  git branch -d "$1"
}

task_publish(){
  git push "$ORIGIN" "$1"
}

task_update(){
  curl https://raw.github.com/xthom/gitf/master/bin/install | sh
}

require_root_branch(){
  git checkout -q $ROOT_BRANCH
  if [[ $"`get_current_branch`" != "master" ]] ;
    then echo "Failed to checkout $ROOT_BRANCH">&2 && exit 1; 
  fi
}

get_current_branch(){
  git symbolic-ref HEAD 2>/dev/null | cut -d"/" -f 3
}

usage() {
  echo "usage..."
}

([[ $# -eq 0 ]] && usage) || `task_$1 $2`

